#!/bin/bash

echo "ğŸš€ ç›´æ¥é€šä¿¡å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç’°å¢ƒã‚’æ§‹ç¯‰ä¸­..."

# æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤
tmux kill-session -t agents 2>/dev/null || true

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p .ai/{logs,instructions}
mkdir -p tmp
mkdir -p shared

# æŒ‡ç¤ºæ›¸ä½œæˆ
echo "ğŸ“ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæŒ‡ç¤ºæ›¸ã‚’ä½œæˆä¸­..."
cat > .ai/instructions/leader.md << 'EOF'
# LEADERã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæŒ‡ç¤ºæ›¸

ã‚ãªãŸã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®LEADERã§ã™ã€‚

## ğŸ“š å‚è€ƒè³‡æ–™
å¿…è¦ã«å¿œã˜ã¦æ—¢å­˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
- 06_multi_agent_operational_workflow.md - é‹ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- 08_practical_agent_communication_system.md - é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ è©³ç´°

## ğŸ¯ ç›´æ¥é€šä¿¡ãƒ«ãƒ¼ãƒ«
ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æŒ‡ç¤ºã‚’å‡ºã™ã¨ãã¯ã€ä»¥ä¸‹ã®å½¢å¼ã§é€ä¿¡ã—ã¦ãã ã•ã„ï¼š

### engineer-1ã¸ã®æŒ‡ç¤ºé€ä¿¡
```
engineer-1ã¸ã®æŒ‡ç¤º: [å…·ä½“çš„ãªæŒ‡ç¤ºå†…å®¹]
```

### engineer-2ã¸ã®æŒ‡ç¤ºé€ä¿¡  
```
engineer-2ã¸ã®æŒ‡ç¤º: [å…·ä½“çš„ãªæŒ‡ç¤ºå†…å®¹]
```

### engineer-3ã¸ã®æŒ‡ç¤ºé€ä¿¡
```
engineer-3ã¸ã®æŒ‡ç¤º: [å…·ä½“çš„ãªæŒ‡ç¤ºå†…å®¹]
```

### qa-agentã¸ã®æŒ‡ç¤ºé€ä¿¡
```
qa-agentã¸ã®æŒ‡ç¤º: [å…·ä½“çš„ãªæŒ‡ç¤ºå†…å®¹]
```

## ğŸ“¤ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹ãƒ•ãƒ­ãƒ¼
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰é–‹å§‹æŒ‡ç¤ºãŒã‚ã£ãŸã‚‰ï¼š

1. **å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å½¹å‰²ã‚’èª¬æ˜**
2. **å…·ä½“çš„ãªã‚¿ã‚¹ã‚¯ã‚’åˆ†é…**
3. **å®Œäº†å ±å‘Šã‚’å¾…ã¤**
4. **é€²æ—ç®¡ç†ãƒ»å•é¡Œè§£æ±ºæ”¯æ´**

ä¾‹ï¼š
```
engineer-1ã¸ã®æŒ‡ç¤º: æ©Ÿèƒ½Aï¼ˆèªè¨¼æ©Ÿèƒ½ï¼‰ã‚’æ‹…å½“ã—ã¦ãã ã•ã„ã€‚git worktreeç’°å¢ƒã‚’ä½œæˆã—ã¦èªè¨¼APIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚å®Œäº†ã—ãŸã‚‰ã€Œengineer-1å®Œäº†ã€ã¨å ±å‘Šã—ã¦ãã ã•ã„ã€‚

engineer-2ã¸ã®æŒ‡ç¤º: æ©Ÿèƒ½Bï¼ˆãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½ï¼‰ã‚’æ‹…å½“ã—ã¦ãã ã•ã„ã€‚git worktreeç’°å¢ƒã‚’ä½œæˆã—ã¦ãƒ‡ãƒ¼ã‚¿CRUD APIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚å®Œäº†ã—ãŸã‚‰ã€Œengineer-2å®Œäº†ã€ã¨å ±å‘Šã—ã¦ãã ã•ã„ã€‚

engineer-3ã¸ã®æŒ‡ç¤º: æ©Ÿèƒ½Cï¼ˆAPIçµ±åˆæ©Ÿèƒ½ï¼‰ã‚’æ‹…å½“ã—ã¦ãã ã•ã„ã€‚git worktreeç’°å¢ƒã‚’ä½œæˆã—ã¦å¤–éƒ¨APIé€£æºã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚å®Œäº†ã—ãŸã‚‰ã€Œengineer-3å®Œäº†ã€ã¨å ±å‘Šã—ã¦ãã ã•ã„ã€‚

qa-agentã¸ã®æŒ‡ç¤º: å…¨æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¨­è¨ˆãƒ»å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚å®Œäº†ã—ãŸã‚‰ã€Œqa-agentå®Œäº†ã€ã¨å ±å‘Šã—ã¦ãã ã•ã„ã€‚
```
EOF

cat > .ai/instructions/engineer.md << 'EOF'
# Engineerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæŒ‡ç¤ºæ›¸

ã‚ãªãŸã¯é–‹ç™ºã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚

## ğŸ“š å‚è€ƒè³‡æ–™
å¿…è¦ã«å¿œã˜ã¦æ—¢å­˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
- 06_multi_agent_operational_workflow.md - é‹ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- 08_practical_agent_communication_system.md - é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ è©³ç´°

## ğŸ¯ ç›´æ¥é€šä¿¡ãƒ«ãƒ¼ãƒ«
ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨é€£æºã™ã‚‹ã¨ãã¯ã€ä»¥ä¸‹ã®å½¢å¼ã§é€ä¿¡ã—ã¦ãã ã•ã„ï¼š

### ä»–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¸ã®é€£çµ¡
```
[ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå]ã¸ã®é€£çµ¡: [é€£çµ¡å†…å®¹]
```

### QAã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®é€£çµ¡
```
qa-agentã¸ã®é€£çµ¡: [é€£çµ¡å†…å®¹]
```

### LEADERã¸ã®å ±å‘Š
```
LEADERã¸ã®å ±å‘Š: [å ±å‘Šå†…å®¹]
```

## ğŸ“ å®Ÿè£…ãƒ•ãƒ­ãƒ¼
1. **LEADERã‹ã‚‰ã®æŒ‡ç¤ºã‚’å—ä¿¡ãƒ»ç†è§£**
2. **å¿…è¦ã«å¿œã˜ã¦ä»–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨é€£æº**
3. **å®Ÿè£…ä½œæ¥­ã‚’å®Ÿè¡Œ**
4. **å®Œäº†ã—ãŸã‚‰LEADERã«å ±å‘Š**

## ğŸ’¬ é€£æºä¾‹
```
engineer-2ã¸ã®é€£çµ¡: èªè¨¼APIã®ä»•æ§˜ãŒæ±ºã¾ã‚Šã¾ã—ãŸã€‚ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ /api/auth/login ã«POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã¯ { email: string, password: string } ã§ã™ã€‚

engineer-3ã¸ã®é€£çµ¡: ãƒ‡ãƒ¼ã‚¿ç®¡ç†APIãŒå®Œæˆã—ã¾ã—ãŸã€‚/api/data/* ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚çµ±åˆä½œæ¥­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

qa-agentã¸ã®é€£çµ¡: æ‹…å½“æ©Ÿèƒ½ã®å®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ãƒ†ã‚¹ãƒˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

LEADERã¸ã®å ±å‘Š: engineer-1ã®å®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸã€‚èªè¨¼æ©Ÿèƒ½ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’å®Ÿè£…æ¸ˆã¿ã§ã™ã€‚
```
EOF

cat > .ai/instructions/qa-agent.md << 'EOF'
# QAã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæŒ‡ç¤ºæ›¸

ã‚ãªãŸã¯QAãƒ»ãƒ†ã‚¹ãƒˆæ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚

## ğŸ“š å‚è€ƒè³‡æ–™
å¿…è¦ã«å¿œã˜ã¦æ—¢å­˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
- 06_multi_agent_operational_workflow.md - é‹ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- 08_practical_agent_communication_system.md - é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ è©³ç´°

## ğŸ¯ ç›´æ¥é€šä¿¡ãƒ«ãƒ¼ãƒ«
ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨é€£æºã™ã‚‹ã¨ãã¯ã€ä»¥ä¸‹ã®å½¢å¼ã§é€ä¿¡ã—ã¦ãã ã•ã„ï¼š

### ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¸ã®è³ªå•ãƒ»é€£çµ¡
```
[ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå]ã¸ã®è³ªå•: [è³ªå•å†…å®¹]
```

### LEADERã¸ã®å ±å‘Š
```
LEADERã¸ã®å ±å‘Š: [å ±å‘Šå†…å®¹]
```

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼
1. **LEADERã‹ã‚‰ã®æŒ‡ç¤ºã‚’å—ä¿¡**
2. **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰å®Ÿè£…å®Œäº†é€£çµ¡ã‚’å—ä¿¡**
3. **ãƒ†ã‚¹ãƒˆè¨­è¨ˆãƒ»å®Ÿè¡Œ**  
4. **å•é¡ŒãŒã‚ã‚Œã°ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«é€£çµ¡**
5. **å®Œäº†ã—ãŸã‚‰LEADERã«å ±å‘Š**

## ğŸ’¬ é€£æºä¾‹
```
engineer-1ã¸ã®è³ªå•: èªè¨¼æ©Ÿèƒ½ã§ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã¯ã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚Œã¾ã™ã‹ï¼Ÿ

engineer-2ã¸ã®è³ªå•: ãƒ‡ãƒ¼ã‚¿ç®¡ç†APIã®ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

engineer-3ã¸ã®è³ªå•: å¤–éƒ¨APIé€£æºã§ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ã¯ã©ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ

LEADERã¸ã®å ±å‘Š: qa-agentã®ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚å…¨35ä»¶ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒæˆåŠŸã—ã€å“è³ªåŸºæº–ã‚’æº€ãŸã—ã¦ã„ã¾ã™ã€‚
```
EOF

# agentsã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆï¼ˆ5ãƒšã‚¤ãƒ³ï¼‰
echo "ğŸ“Š agentsã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆä¸­..."
tmux new-session -d -s agents

# ãƒšã‚¤ãƒ³åˆ†å‰²ï¼ˆLEADER 40%, engineer-1 20%, engineer-2 20%, engineer-3 10%, qa-agent 10%ï¼‰
tmux split-window -h -t agents
tmux split-window -v -t agents:0.1
tmux split-window -v -t agents:0.2
tmux split-window -v -t agents:0.3

# ãƒšã‚¤ãƒ³åè¨­å®š
tmux send-keys -t agents:0.0 'echo "ğŸ‘‘ LEADER ready"' C-m
tmux send-keys -t agents:0.1 'echo "ğŸ’» engineer-1 ready"' C-m
tmux send-keys -t agents:0.2 'echo "ğŸ–¥ï¸ engineer-2 ready"' C-m
tmux send-keys -t agents:0.3 'echo "âš™ï¸ engineer-3 ready"' C-m
tmux send-keys -t agents:0.4 'echo "ğŸ§ª qa-agent ready"' C-m

# é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
echo "ğŸ“¡ ç›´æ¥é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­..."
echo "$(date): Direct communication system initialized" > .ai/logs/communication.log

echo "âœ… ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼"
echo ""
echo "ğŸ“ ä½¿ç”¨æ–¹æ³•:"
echo "  tmux attach-session -t agents      # å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³"
echo ""
echo "ğŸš€ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•:"
echo "  ./start-agents.sh" 